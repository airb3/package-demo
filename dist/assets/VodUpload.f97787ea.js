/* empty css               */import{d as C,r as T,o as B,c as y,a as r,b as F,w as v,e as V,f as x,g as A,h as S,_ as w,i as P,j as D,t as $,u as f,E as k}from"./index.17f95cc3.js";const R={class:"upload"},I={class:"uploadBox"},L=r("i",{class:"el-icon-upload"},null,-1),M=r("div",{class:"el-upload__text"},[x("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),r("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1),j={name:"default"},b=C({__name:"VodUpload",props:{uploadURL:null,reflushURL:null},emits:["progress"],setup(p,{expose:m,emit:d}){const c=p,u=T({timeout:0,partSize:0,parallel:0,retryCount:0,retryDuration:0,region:"cn-beijing",userId:"1235",file:null,title:"",authProgress:0,uploadDisabled:!0,resumeDisabled:!0,pauseDisabled:!0,uploader:null,statusText:""});function _(){return d("progress",u.authProgress)}function h(e){if(console.log("\u6587\u4EF6\u5BF9\u8C61",e),u.file=e.raw,!u.file){alert("\u8BF7\u5148\u9009\u62E9\u9700\u8981\u4E0A\u4F20\u7684\u6587\u4EF6!");return}var l='{"Vod":{}}';u.uploader&&(u.uploader.stopUpload(),u.authProgress=0,u.statusText=""),u.uploader=i(),console.log(l),u.uploader.addFile(u.file,null,null,null,l),u.uploadDisabled=!1,u.pauseDisabled=!0,u.resumeDisabled=!0}function g(){u.uploader!==null&&(console.log("\u505C\u6B62\u4E0A\u4F20"),u.uploader.stopUpload(),u.resumeDisabled=!1,u.pauseDisabled=!0)}function a(){console.log("\u6062\u590D\u4E0A\u4F20"),u.uploader!==null&&(u.uploader.startUpload(),u.resumeDisabled=!0,u.pauseDisabled=!1)}function i(){let e=u;e.title=e.file.name;let l=new window.AliyunUpload.Vod({timeout:e.timeout||6e4,partSize:Math.round(e.partSize||1048576),parallel:e.parallel||5,retryCount:e.retryCount||3,retryDuration:e.retryDuration||2,region:e.region,userId:e.userId,addFileSuccess:function(t){console.log("\u6DFB\u52A0\u6587\u4EF6\u6210\u529F, \u4E0A\u4F20\u4FE1\u606F\uFF1A",t),e.uploadDisabled=!1,e.resumeDisabled=!1,e.statusText="\u6DFB\u52A0\u6587\u4EF6\u6210\u529F, \u7B49\u5F85\u4E0A\u4F20...",console.log("addFileSuccess: "+t.file.name)},onUploadstarted:async function(t){if(console.log("\u9884\u4E0A\u4F20\u6570\u636E\uFF1A",t),t.videoId){let s=c.reflushURL+"?name="+e.title+"&type=2",o=await A.get(s),n=o.data.data.uploadAuth,U=o.data.data.uploadAddress,E=o.data.data.videoId;l.setUploadAuthAndAddress(t,n,U,E)}else{let s=c.uploadURL+"?name="+e.title+"&type=1",o=await A.get(s),n=o.data.data.uploadAuth,U=o.data.data.uploadAddress,E=o.data.data.videoId;l.setUploadAuthAndAddress(t,n,U,E),e.statusText="\u6587\u4EF6\u5F00\u59CB\u4E0A\u4F20..."}},onUploadSucceed:function(t){console.log("onUploadSucceed: "+t.file.name+", endpoint:"+t.endpoint+", bucket:"+t.bucket+", object:"+t.object),e.statusText="\u6587\u4EF6\u4E0A\u4F20\u6210\u529F!"},onUploadFailed:function(t,s,o){console.log("onUploadFailed: file:"+t.file.name+",code:"+s+", message:"+o),e.statusText="\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25!"},onUploadCanceled:function(t,s,o){console.log("Canceled file: "+t.file.name+", code: "+s+", message:"+o),e.statusText="\u6587\u4EF6\u5DF2\u6682\u505C\u4E0A\u4F20"},onUploadProgress:function(t,s,o){let n=Math.ceil(o*100);e.authProgress=n,e.statusText="\u6587\u4EF6\u4E0A\u4F20\u4E2D...",_()},onUploadTokenExpired:function(t){let s="https://demo-vod.cn-shanghai.aliyuncs.com/voddemo/RefreshUploadVideo?BusinessType=vodai&TerminalType=pc&DeviceModel=iPhone9,2&UUID=59ECA-4193-4695-94DD-7E1247288&AppVersion=1.0.0&Title=haha1&FileName=xxx.mp4&VideoId="+t.videoId;A.get(s).then(({data:o})=>{let n=o.UploadAuth;l.resumeUploadWithAuth(n),console.log("upload expired and resume upload with uploadauth "+n)}),e.statusText="\u6587\u4EF6\u8D85\u65F6..."},onUploadEnd:function(t){console.log("onUploadEnd: uploaded all the files"),console.log("\u4E0A\u4F20Successful",t),e.statusText="\u6587\u4EF6\u4E0A\u4F20\u5B8C\u6BD5"}});return l}return m({pauseUpload:g,resumeUpload:a,data:u}),(e,l)=>{const t=S("el-upload");return B(),y("div",R,[r("div",I,[F(t,{class:"uploadBox",action:"",drag:"",multiple:!0,onChange:l[0]||(l[0]=s=>h(s))},{default:v(()=>[L,M]),_:1})]),r("template",j,[V(e.$slots,"default")])])}}});b.install=p=>{p.component("AliyunVodUpload",b)};const z={class:"root"},N={class:"demo"},O={class:"btn"},W=x("\u505C\u6B62"),q=x("\u5F00\u59CB\u4E0A\u4F20"),G=C({__name:"VodUpload",setup(p){function m(a){console.log("\u56DE\u8C03\u4E8B\u4EF6\uFF1A",a)}const d=P(),c=D(()=>{var a;return(a=d.value)==null?void 0:a.data.pauseDisabled}),u=D(()=>{var a;return(a=d.value)==null?void 0:a.data.resumeDisabled}),_=D(()=>{var a;return(a=d.value)==null?void 0:a.data.statusText});function h(){console.log("UploadDOM",d.value),d.value.pauseUpload()}function g(){console.log("UploadDOM",d.value),d.value.resumeUpload()}return(a,i)=>{const e=k;return B(),y("div",z,[r("div",N,[r("span",null,$(f(_)),1),F(f(b),{ref_key:"VodDom",ref:d,onProgress:m,uploadURL:"http://localhost:8000/vod",reflushURL:"http://localhost:8000/vod"},null,512)]),r("div",O,[F(e,{disabled:f(c),onClick:i[0]||(i[0]=l=>h())},{default:v(()=>[W]),_:1},8,["disabled"]),F(e,{disabled:f(u),onClick:i[1]||(i[1]=l=>g())},{default:v(()=>[q]),_:1},8,["disabled"])])])}}});var K=w(G,[["__scopeId","data-v-abe54bcc"]]);export{K as default};
